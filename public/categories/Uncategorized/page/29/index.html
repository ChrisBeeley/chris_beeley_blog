<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head><script src="/chris_beeley_blog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=chris_beeley_blog/livereload" data-no-instant defer></script>
    
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>Uncategorized - Chris Beeley&#39;s blog</title>
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Chris Beeley\u0027s blog",
    
    "url": "http:\/\/localhost:1313\/chris_beeley_blog\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "http:\/\/localhost:1313\/chris_beeley_blog\/"
  
  
  
  
}
</script>

<meta property="og:url" content="http://localhost:1313/chris_beeley_blog/categories/Uncategorized/">
<meta property="og:type" content="website">
<meta property="og:site_name" content="Chris Beeley&#39;s blog">
   
<link rel="apple-touch-icon" sizes="180x180" href=" http://localhost:1313/chris_beeley_blog/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/chris_beeley_blog/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/chris_beeley_blog/favicon/favicon-16x16.png">


<meta name="generator" content="Hugo 0.124.1"><link rel="alternate" href="http://localhost:1313/chris_beeley_blog/index.xml" type="application/rss+xml" title="Chris Beeley&#39;s blog">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
<link rel="stylesheet" href="http://localhost:1313/chris_beeley_blog/css/main.css">
<link disabled id="dark-mode-theme" rel="stylesheet" href="http://localhost:1313/chris_beeley_blog/css/dark.css"><link rel="stylesheet" href="http://localhost:1313/chris_beeley_blog/css/syntax.css"><link rel="stylesheet" href="http://localhost:1313/chris_beeley_blog/css/codeblock.css">




  </head>
  <body>
    
<div class="container fixed-top">
  <div class="row justify-content-center">
    <div class="col-sm-12 col-md-12 col-lg-10 col-xl-10">

      <nav class="navbar navbar-expand-lg navbar-light fixed-top p-0">
        <div class="container">
          
          <a class="navbar-brand fw-bold" href="http://localhost:1313/chris_beeley_blog/">Chris Beeley&#39;s blog</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
            <ul class="navbar-nav mb-2 mb-lg-0">
              

              
              <li class="nav-item nav-link">
                <a id="dark-mode-toggle" class="bi bi-sun"></a>
              </li>
              
            </ul>
          </div>
        </div>
      </nav>

    </div>
  </div>
</div>
    









<header class="header-section ">

  <div class="intro-header no-img mt-10">
    <div class="container">
      <div class="row justify-content-center">
        

          
          <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12">
            

            <div class="categories-heading">
              

              

              

              
              

              

              
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-md-12">
       
      <div class="row">
        
          <div class="col-xl-4 col-lg-4 col-md-6 col-sm-6  mb-4">
    <div class="card h-100 single-post-card shadow-effect bg-faded-light">
        <a href="http://localhost:1313/chris_beeley_blog/?p=25/">
            <div class="card-body">

                <h3 class="fw-bold post-title">Fun with wordclouds</h3>
                

                <p class="post-meta">
                    <span class="post-meta">
  
  
  &nbsp;August 2, 2011 

  

  
  
  
</span>


                </p>
                
                <div class="post-entry">

                    
                    <p>As always, I’m late to this party, and wordclouds have come under fire in recent times, e.g. here: <a href="http://www.drewconway.com/zia/?p=2624">drewconway.com</a>. From my point of view they’re eye-catching, and I hope that by putting them up on a website or in a report they might cause people to linger and look in more detail at other pieces of data and visualisation. That’s all I’m going to say for now, I’m sure I’ll talk again about what’s attractive to data scientists and statisticians and what’s attractive to the general public, but let’s leave it for now.</p>
<p>I am looking at interesting ways of looking at the patient survey (see previous post) at the moment and I thought I would have a go at a wordcloud. Thanks to the wonderful people producing packages for R (the tm and wordcloud packages, many thanks to both!), it’s easy. I nicked a bit of code from another blog (thanks <a href="http://onertipaday.blogspot.com/2011/07/word-cloud-in-r.html">One R tip a day</a>!) and pretty soon I had my own. It’s from two areas of the Trust, featuring the things people like about our services.</p>
<p>Here’s the code:</p>
<pre tabindex="0"><code>&lt;pre class=&#34;brush: r; title: ; notranslate&#34; title=&#34;&#34;&gt;

mydata=subset(mydatafirst, Var1==0) # slice the data by area

mycorpus=Corpus(DataframeSource(data.frame(mydata[-is.na(mydata$Best),34]))) # make a text corpus for the tm package out of a data frame, removing missing values at the same time

mycorpus &amp;lt;- tm_map(mycorpus, removePunctuation) # remove all the puncuation
mycorpus &amp;lt;- tm_map(mycorpus, tolower) # make everything lower case
mycorpus &amp;lt;- tm_map(mycorpus, function(x) removeWords(x, c(stopwords(&amp;quot;english&amp;quot;), &amp;quot;none&amp;quot;, &amp;quot;ive&amp;quot;, &amp;quot;dont&amp;quot;, &amp;quot;etc&amp;quot;))) # remove words without meaning, many of which are provided by the stopwords(&amp;quot;english&amp;quot;) function

# these next steps take the corpus and turn it into a dataframe ready for the wordcloud function

tdm &amp;lt;- TermDocumentMatrix(mycorpus)
m &amp;lt;- as.matrix(tdm)
v &amp;lt;- sort(rowSums(m),decreasing=TRUE)
d &amp;lt;- data.frame(word = names(v),freq=v)

par(mfrow=c(1,2))

wordcloud(d$word,d$freq,c(3.5,.5),2,100,TRUE,.15, terrain.colors(5),vfont=c(&amp;quot;sans serif&amp;quot;,&amp;quot;plain&amp;quot;))

# ...same steps again for the other area

wordcloud(d2$word,d2$freq,scale=c(4,.5),2,100,TRUE,.15, terrain.colors(5),vfont=c(&amp;quot;sans serif&amp;quot;,&amp;quot;plain&amp;quot;))
</code></pre><p>I adjusted by eye the scale which you can see in the 3rd parameter of the wordcloud function (making the second area a bit larger). There’s probably a better way, I will investigate further as I look more at what to do with all this data.</p>
<p>Here’s the word cloud:</p>
<p><a href="http://chrisbeeley.net/wp-content/uploads/2011/08/rplot02.pdf">Rplot02</a></p>
<p>Not bad for a few hours’ work! I’m hoping it will draw people in to look at more of the reporting that we do at any rate. Let me know what you think of it, and word clouds generally, in the comments.</p>

                    
                </div>

                <div class="read-more-section">
                    <h6>Read more</h6>
                </div>
            </div>

            
            
        </a>
    </div>
</div> 
        
          <div class="col-xl-4 col-lg-4 col-md-6 col-sm-6  mb-4">
    <div class="card h-100 single-post-card shadow-effect bg-faded-light">
        <a href="http://localhost:1313/chris_beeley_blog/?p=8/">
            <div class="card-body">

                <h3 class="fw-bold post-title">The patient survey: past, present and future</h3>
                

                <p class="post-meta">
                    <span class="post-meta">
  
  
  &nbsp;August 1, 2011 

  

  
  
  
</span>


                </p>
                
                <div class="post-entry">

                    
                    <p>Within my organisation we have something known as the Service User and Carer Experience Survey, often abbreviated to the SUCE, or in more natural spoken English, the patient survey. It’s a chance for the users of our services to tell us about our services and includes Likert-type “ticky box” questions about specific aspects of care as well as an open section in which they can give an area for improvement as well as something they like about the service. Results are published quarterly and reporting represents a major challenge- we report over about 100 teams, all organised into larger directorates and divisions, with each category having its own type of report. I’ve been involved right from the start and the process goes nicely from a How-Not-To-Do-It guide to a How-To guide.</p>
<p>At first I was responsible for all data entry and reporting and in my naïveté I did everything manually. I made a page in Microsoft Excel which automatically generated frequency tables from raw data, and then fed those values into pie charts (yes I know: <a href="http://www.juiceanalytics.com/writing/the-problem-with-pie-charts/">juiceanalytics.com/writing/the-problem-with-pie-charts</a> but I’m afraid many find them accessible, possibly due to familiarity? Or just overall “friendly” appearance?). I made the bar graphs in SPSS. The whole thing took ages and was done quarterly. The first step on the road to getting the computer to shoulder this massive burden was writing some R (<a href="http://cran.r-project.org/">The R project</a>) code which produced the graphs. It was very easy to do, I was a real novice back then, and here it is:</p>
<pre tabindex="0"><code>&lt;pre class=&#34;brush: r; title: ; notranslate&#34; title=&#34;&#34;&gt;

# select the current team, denoted x, and select the most recent mydata for the pie charts (put into Subset.P). Put data for the team from all points of time into Subset.B, which will be used to draw the barcharts 

Subset.P=subset(mymydata, mydata$Code==x &amp; mydata$Time==8)
Subset.B=subset(mymydata, mydata$Code==x)

# add labels to each variable, and calculate the percentages in each category

Service.P=table(factor(Subset.P$Service, levels=1:6, labels=c(&#34;Very poor&#34;, &#34;Poor&#34;, &#34;Fair&#34;, &#34;Good&#34;, &#34;Very good&#34;, &#34;Excellent&#34;)))
Service.P=Service.P/sum(Service.P)
names(Service.P) &amp;lt;- paste(names(Service.P), &#34;-&#34;, round(Service.P*100), &#34;%&#34;, sep=&#34;&#34;)

# this bit fixes the colours and steps through each category removing the colours from the empty categories. Without this step the colours aren&#39;t consistent if there are any empty categories

attributes(Service.P)$cols &lt;- rainbow(6)
    if(0 %in% Service.P){
        ind &lt;- which(Service.P == 0)
        Service.P &lt;- Service.P[-ind]
        attributes(Service.P)$cols &lt;- rainbow(6)[-ind]
    }

# and so on for each question

Comm.P=table(factor(Subset.P$Communication, levels=1:6, labels=c(&#34;Very poor&#34;, &#34;Poor&#34;, &#34;Fair&#34;, &#34;Good&#34;, &#34;Very good&#34;, &#34;Excellent&#34;)))
Comm.P=Comm.P/sum(Comm.P)
names(Comm.P) &lt;- paste(names(Comm.P), &#34;-&#34;, round(Comm.P*100), &#34;%&#34;, sep=&#34;&#34;)
attributes(Comm.P)$cols &lt;- rainbow(6)
    if(0 %in% Comm.P){
        ind &lt;- which(Comm.P == 0)
        Comm.P &lt;- Comm.P[-ind]
        attributes(Comm.P)$cols &lt;- rainbow(6)[-ind]
}

#... I&#39;ve edited the repetitions of the above out to save space

# draw all the charts in a 3 by 2 grid ready for copying straight into the report (the last graph is drawn later)

par(mfrow=c(3,2))

pie(Service.P, clockwise=TRUE, main = c(&#34;Service quality&#34;), radius=1, cex=1.1, init.angle=45, col=attr(Service.P, &#34;cols&#34;))
pie(Comm.P, clockwise=TRUE, main = c(&#34;Communication&#34;), radius=1, cex=1.3, init.angle=45, col=attr(Comm.P, &#34;cols&#34;))
pie(Ldign.P, clockwise=TRUE, main = c(&#34;Dignity and respect&#34;), radius=1, cex=1.3, init.angle=45, col=attr(Ldign.P, &#34;cols&#34;))
pie(Involved.P, clockwise=TRUE, main = c(&#34;Involved in care&#34;), radius=1, cex=1.3, init.angle=45, col=attr(Involved.P, &#34;cols&#34;))
pie(Improved.P, clockwise=TRUE, main = c(&#34;Improved life&#34;), radius=1, cex=1.3, init.angle=45, col=attr(Improved.P, &#34;cols&#34;))

# take the Subset.B data, which contains all data for each team across each time point, as opposed to the Subset.P which is just this quarter&#39;s data for the pie charts

# also multiply the figures to fix them all at a maximum of 5

Subset.B$Service=Subset.B$Service*5/6
Subset.B$Communication=Subset.B$Communication*5/6
Subset.B$Ldign=Subset.B$Ldign*5/3
Subset.B$Involved=Subset.B$Involved*5/3

# produce a matrix, ybar, which will hold the responses for each
# question at 5 time points- last year and the next 4 quarters

ybar=as.data.frame(matrix(data=NA, nrow=5, ncol=5))
names(ybar)=c(&#34;Apr - Mar 10&#34;, &#34;Apr - Jun 10&#34;, &#34;Jul - Sept 10&#34;, &#34;Oct - Dec 10&#34;, &#34;Jan - Mar 11&#34;)

# construct each one from the mean at time &lt; 5, time==6, time==7 etc.

ybar[1,] = c(mean(subset(Subset.B, Time&lt;5)$Service, na.rm=TRUE),
             mean(subset(Subset.B, Time==5)$Service, na.rm=TRUE),
             mean(subset(Subset.B, Time==6)$Service, na.rm=TRUE),
             mean(subset(Subset.B, Time==7)$Service, na.rm=TRUE),
             mean(subset(Subset.B, Time==8)$Service, na.rm=TRUE))

ybar[2,] = c(mean(subset(Subset.B, Time,5)$Communication, na.rm=TRUE),
             mean(subset(Subset.B, Time==5)$Communication, na.rm=TRUE),
             mean(subset(Subset.B, Time==6)$Communication, na.rm=TRUE),
             mean(subset(Subset.B, Time==7)$Communication, na.rm=TRUE),
             mean(subset(Subset.B, Time==8)$Communication, na.rm=TRUE))

ybar[3,] = c(mean(subset(Subset.B, Time&lt;5)$Ldign, na.rm=TRUE),
             mean(subset(Subset.B, Time==5)$Ldign, na.rm=TRUE),
             mean(subset(Subset.B, Time==6)$Ldign, na.rm=TRUE),
             mean(subset(Subset.B, Time==7)$Ldign, na.rm=TRUE),
             mean(subset(Subset.B, Time==8)$Ldign, na.rm=TRUE))

ybar[4,] = c(mean(subset(Subset.B, Time&lt;5)$Involved, na.rm=TRUE),
             mean(subset(Subset.B, Time==5)$Involved, na.rm=TRUE),
             mean(subset(Subset.B, Time==6)$Involved, na.rm=TRUE),
             mean(subset(Subset.B, Time==7)$Involved, na.rm=TRUE),
             mean(subset(Subset.B, Time==8)$Involved, na.rm=TRUE))

ybar[5,] = c(mean(subset(Subset.B, Time&amp;lt;5)$Improved, na.rm=TRUE),
             mean(subset(Subset.B, Time==5)$Improved, na.rm=TRUE),
             mean(subset(Subset.B, Time==6)$Improved, na.rm=TRUE),
             mean(subset(Subset.B, Time==7)$Improved, na.rm=TRUE),
             mean(subset(Subset.B, Time==8)$Improved, na.rm=TRUE))

# remove all the empty bits, to prevent the graph containing ugly holes

if(is.na(ybar[,1])|is.na(ybar[,2])|is.na(ybar[,3])|is.na(ybar[,4])){
ybar=ybar[-which(is.nan(ybar[1,])==TRUE)]
}

# draw the graph, the enormous ylim value is to give room at the top for the legend 

barplot(as.matrix(ybar), beside=T, col=rainbow(5), ylim=c(0,9), yaxt = &#34;n&#34;)
axis(2, at = 0:5)
legend(&#34;top&#34;, legend=c(&#34;Service quality&#34;, &#34;Communication&#34;, &#34;Dignity and respect&#34;,
                       &#34;Involved with care&#34;, &#34;Improved life&#34;), fill=rainbow(5), bty=&#34;n&#34;, cex=1, ncol = 2 )

# now manually change the value of x to go to the next team and re-run the code
</code></pre><p>This greatly sped up the process of producing the graphs, but left a lot of the process in the hands of a human- figuring out which teams were reporting that quarter, running the code, pasting the graphs, counting the responses, etc. etc. As I’ve grown more confident I’ve given more and more of these tasks to the computer and saved more and more time. I’ll show some more of the steps in subsequent posts, leading up to where we are now and plans for the future.</p>

                    
                </div>

                <div class="read-more-section">
                    <h6>Read more</h6>
                </div>
            </div>

            
            
        </a>
    </div>
</div> 
        
          <div class="col-xl-4 col-lg-4 col-md-6 col-sm-6  mb-4">
    <div class="card h-100 single-post-card shadow-effect bg-faded-light">
        <a href="http://localhost:1313/chris_beeley_blog/?p=5/">
            <div class="card-body">

                <h3 class="fw-bold post-title">Welcome to the blog</h3>
                

                <p class="post-meta">
                    <span class="post-meta">
  
  
  &nbsp;August 1, 2011 

  

  
  
  
</span>


                </p>
                
                <div class="post-entry">

                    
                    <p>Inspired by the many excellent blogs about research, statistics, and computing I have finally decided to set up my own. My work for Nottinghamshire Healthcare NHS Trust and the Institute of Mental Health comprises advice and consultancy, research and evaluation, and data visualisation. I like to use R for my statistics, and have recently started making reproducible research using Sweave and odfWeave. Over time I have found I need to write more and more code and I am studying Java in October to help me on the way to being a proper programmer.</p>
<p>Expect posts about all of these things, and miscellany relating to statistics, data science and healthcare. To get started I’m going to do some retrospective posts over the next few weeks about what brought me here, some of my project work, and where I’m going over the next year.</p>
<p>In this and all subsequent posts the content reflects my own beliefs and opinions, not those of Nottinghamshire Healthcare NHS Trust, the NHS, or the Institute of Mental health or any of its partners.</p>

                    
                </div>

                <div class="read-more-section">
                    <h6>Read more</h6>
                </div>
            </div>

            
            
        </a>
    </div>
</div> 
        
      </div>
    </div>
  </div>
</div>

<div class="container">
 <div class="row font-sans"> 
   <div class="col-md-12 mt-10">
      <nav aria-label="Page navigation"> 
      <ul class= "pagination justify-content-end">    
      
    <ul class="pagination pagination-default">
      <li class="page-item">
        <a href="/chris_beeley_blog/categories/Uncategorized/" aria-label="First" class="page-link" role="button"><span aria-hidden="true">&laquo;&laquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/chris_beeley_blog/categories/Uncategorized/page/28/" aria-label="Previous" class="page-link" role="button"><span aria-hidden="true">&laquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/chris_beeley_blog/categories/Uncategorized/page/25/" aria-label="Page 25" class="page-link" role="button">25</a>
      </li>
      <li class="page-item">
        <a href="/chris_beeley_blog/categories/Uncategorized/page/26/" aria-label="Page 26" class="page-link" role="button">26</a>
      </li>
      <li class="page-item">
        <a href="/chris_beeley_blog/categories/Uncategorized/page/27/" aria-label="Page 27" class="page-link" role="button">27</a>
      </li>
      <li class="page-item">
        <a href="/chris_beeley_blog/categories/Uncategorized/page/28/" aria-label="Page 28" class="page-link" role="button">28</a>
      </li>
      <li class="page-item active">
        <a aria-current="page" aria-label="Page 29" class="page-link" role="button">29</a>
      </li>
      <li class="page-item disabled">
        <a aria-disabled="true" aria-label="Next" class="page-link" role="button" tabindex="-1"><span aria-hidden="true">&raquo;</span></a>
      </li>
      <li class="page-item disabled">
        <a aria-disabled="true" aria-label="Last" class="page-link" role="button" tabindex="-1"><span aria-hidden="true">&raquo;&raquo;</span></a>
      </li>
    </ul> 
      </ul>
      </nav> 
    </div>
  </div>
</div>


    


<footer>

  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <ul
          class="list-inline list-group list-group-horizontal text-center footer-links d-flex justify-content-center flex-row">

          
          
        </ul>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <p class="credits copyright text-muted">
          

          &nbsp;&bull;&nbsp;&copy;
          
          2023
          

          
          &nbsp;&bull;&nbsp;
          <a href="http://localhost:1313/chris_beeley_blog/">Chris Beeley&#39;s blog</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          Powered by <a href="https://gohugo.io">Hugo</a> & <a href="https://github.com/binokochumolvarghese/lightbi-hugo">Lightbi.</a>&nbsp; Made with ❤ by <a href="https://binovarghese.com">Bino</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha256-tG5mcZUtJsZvyKAxYLVXrmjKBVLd6VpVccqz/r4ypFE=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js" integrity="sha384-Y4oOpwW3duJdCWv5ly8SCFYWqFDsfob/3GkgExXKV4idmbt98QcxXYs9UoXAB7BZ" crossorigin="anonymous"></script><script src="http://localhost:1313/chris_beeley_blog/js/dark-mode.js"></script>
    
  </body>
</html>

