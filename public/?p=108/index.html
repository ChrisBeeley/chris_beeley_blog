<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/chris_beeley_blog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=chris_beeley_blog/livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Robin Hood marathon results | </title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="I ran the Robin Hood marathon yesterday in a decent-ish 4 hours and 13 minutes, which is my best yet.">
    <meta name="generator" content="Hugo 0.124.1">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/chris_beeley_blog/ananke/css/main.min.css" >



    
    
    
      

    

    
    
    <meta property="og:title" content="Robin Hood marathon results" />
<meta property="og:description" content="I ran the Robin Hood marathon yesterday in a decent-ish 4 hours and 13 minutes, which is my best yet." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/chris_beeley_blog/?p=108/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2011-09-12T16:54:30+00:00" />
<meta property="article:modified_time" content="2011-09-12T16:54:30+00:00" />
<meta itemprop="name" content="Robin Hood marathon results">
<meta itemprop="description" content="I ran the Robin Hood marathon yesterday in a decent-ish 4 hours and 13 minutes, which is my best yet."><meta itemprop="datePublished" content="2011-09-12T16:54:30+00:00" />
<meta itemprop="dateModified" content="2011-09-12T16:54:30+00:00" />
<meta itemprop="wordCount" content="615">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Robin Hood marathon results"/>
<meta name="twitter:description" content="I ran the Robin Hood marathon yesterday in a decent-ish 4 hours and 13 minutes, which is my best yet."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/chris_beeley_blog/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        POSTS
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">Robin Hood marathon results</h1>
      
      <p class="tracked">
        By <strong>chrisbeeley</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2011-09-12T16:54:30Z">September 12, 2011</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>I ran the Robin Hood marathon yesterday in a decent-ish 4 hours and 13 minutes, which is my best yet. Naturally, I was curious to see how my fellow runners fared, and so I have scraped the times from a pdf and summarised them using R and ggplot2.</p>
<p>I ran to support the <!-- raw HTML omitted --><!-- raw HTML omitted -->Disaster Emergency Committee, because of the East Africa Appeal, so if you would like to support this very worthy cause then please go <a href="http://www.justgiving.com/Chris-Beeley">here</a>.</p>
<p>Data scraping, for those that do not know, is the process of taking human-readable files like pdfs and webpages and turning them into computer-readable files like spreadsheets (more <a href="http://en.wikipedia.org/wiki/Data_scraping">here</a>). The scraping itself was very simple since the <a href="http://www.experianfestivalofrunning.co.uk/RobinHoodResults11/FullMarathon11v1.pdf">pdf</a> copy-pasted very nicely into a spreadsheet, which then read into R as a one variable list like so:</p>
<p>1 10038 Carl Allwood M Sutton &amp; Ashfield Harriers 02:38:40 1 02:38:40<br>
2 10098 Adam Holland M Votwo/USN 02:41:25 2 02:41:25<br>
3 13007 Pumlani Bangani M 02:43:23 3 02:43:23<br>
4 10028 Anthony Jackson M Sittingbourne Striders 02:44:39 4 02:44:39<br>
5 10187 Peter Stockdale M 02:45:26 5 02:45:25</p>
<p>The trick was merely to split up these big long strings and separate them into the correct variables, which, reading across, are:</p>
<p>Gun position (i.e. official position), race number, Name, Gender, Athletics club, Gun time (i.e. official time), Chip position and Chip time.</p>
<p>Chip position and chip time are the “real” time for slowcoaches such as myself, since it can take up to 10 minutes for all 15,000 runners to cross the line after the gun has gone- a chip therefore reads the time as you cross the start and finish line.</p>
<p>Code is at the bottom for those who are interested (and I would like to acknowledge the author of <a href="http://mcfromnz.wordpress.com/2011/09/07/2011-perth-city-to-surf-stats/">this</a> post from whom I stole the “seconds” function to convert the times into a numeric format).</p>
<p>All times for finishers is shown below. My own time is represented by a vertical red line, with the median time being a black and dashed vertical line.</p>
<p><a href="http://chrisbeeley.net/wp-content/uploads/2011/09/rplot.png"><img src="http://chrisbeeley.net/wp-content/uploads/2011/09/rplot.png?w=300" alt="" title="Rplot"></a></p>
<p>Next up is the difference between male and female finishers, with medians for each group given as vertical lines.</p>
<p><a href="http://chrisbeeley.net/wp-content/uploads/2011/09/rplot012.png"><img src="http://chrisbeeley.net/wp-content/uploads/2011/09/rplot012.png?w=300" alt="" title="Rplot01"></a></p>
<p>And lastly, a faceted plot showing the differences between different ages and genders. I recoded some of the age categories because they vary across genders which makes a mess of the faceting.</p>
<p><a href="http://chrisbeeley.net/wp-content/uploads/2011/09/rplot02.png"><img src="http://chrisbeeley.net/wp-content/uploads/2011/09/rplot02.png?w=300" alt="" title="Rplot02"></a></p>
<p>The code:</p>
<pre tabindex="0"><code>&lt;pre class=&#34;brush: r; title: ; notranslate&#34; title=&#34;&#34;&gt;
library(ggplot2)
library(car)

mydata=read.csv(&#34;D:\Dropbox\R-files\Marathon\Marathon_times.csv&#34;, stringsAsFactors=FALSE)

mylist1=strsplit(mydata$Var, &#34;&#34;)

# find position, name and gender for all rows

mydata$Gunpos=lapply(mylist1, function(x) x[1])
mydata$Name=lapply(mylist1, function(x) x[3:4])
mydata$Gender=lapply(mylist1, function(x) x[5])

mydata$Chiptime=lapply(mylist1, function(x) x[length(x)])
mydata$Chippos=lapply(mylist1, function(x) x[length(x)-1])
mydata$Guntime=lapply(mylist1, function(x) x[length(x)-2])

# find the rows where the age category is included, i.e. 6th column is numeric

mydata$Age=NA

myvec=unlist(lapply(mylist1, function(x) as.numeric(x[6])&amp;gt;0))
myvec[is.na(myvec)]=FALSE

mydata$Age[myvec]=unlist(lapply(mylist1, function(x) x[6])[myvec])

mydata$Age[is.na(mydata$Age)]=18

str(mydata$Age)
mydata$Age=factor(mydata$Age)

mydata$Age2=recode(mydata$Age, &#34;&#39;18&#39;=&#39;18+&#39;; c(&#39;35&#39;, &#39;40&#39;)=&#39;35+&#39;; c(&#39;45&#39;, &#39;50&#39;)=&#39;45+&#39;; c(&#39;55&#39;, &#39;60&#39;)=&#39;55+&#39;; c(&#39;65&#39;, &#39;70&#39;, &#39;75&#39;)=&#39;65+&#39;&#34;;)

# fix the people with 3 names whose columns are misaligned

mydata$Gender[mydata$Gender!=&#34;M&#34; &amp; mydata$Gender!=&#34;F&#34;]=lapply(mylist1, function(x) x[6])[mydata$Gender!=&#34;M&#34; &amp; mydata$Gender!=&#34;F&#34;]

# fix the three stragglers with four names

mydata$Gender[c(331, 422, 1043)]=&#34;M&#34;

# make gender a nicely formatted factor

mydata$Gender=factor(unlist(mydata$Gender))

# the title snuck in at row 75, delete this

mydata=data.frame(mydata[-75,])

### format the time values

# function from http://mcfromnz.wordpress.com/2011/09/07/2011-perth-city-to-surf-stats/

seconds &lt;- function(x){
  as.numeric(substr(x,1,2)) * 60 * 60 +
  as.numeric(substr(x,4,5)) * 60 +
  as.numeric(substr(x,7,8)) 
}

mydata$Finaltime=seconds(unlist(mydata$Chiptime))/3600

### summarise

# overall
ggplot(mydata, aes(Finaltime)) + 
   labs(colour = &#34;Gender&#34;) + 
   geom_density(size=1)+
   xlim(2, 7.5)+ 
   geom_vline(xintercept = 4+13/60, col=&#34;red&#34;, lty=1) +
   geom_vline(xintercept = median(mydata$Finaltime), col=&#34;black&#34;, lty=2)
   

# by gender
ggplot(mydata, aes(Finaltime, colour = droplevels(Gender))) + 
   labs(colour = &#34;Gender&#34;) + 
   geom_density(size=1) +
   xlim(2, 7.5)+
   geom_vline(xintercept = median(subset(mydata, Gender==&#34;F&#34;)$Finaltime), col=&#34;red&#34;, lty=1) +
   geom_vline(xintercept = median(subset(mydata, Gender==&#34;M&#34;)$Finaltime), col=&#34;blue&#34;, lty=1)

# by age category and gender
ggplot(mydata, aes(Finaltime, colour = droplevels(Gender))) + 
   labs(colour = &#34;Gender&#34;) + 
   geom_density(size=1) + facet_wrap(~Age2)+
   xlim(2, 7.5)
</code></pre><ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/chris_beeley_blog/" >
    &copy; 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
